---
title: Differences in the Gender Pay Gap Across Male and Female-Dominated Workforces
subtitle: 2013-2016 trends in job category and female workforce representation
execute:
  echo: false
  message: false
  warning: false
---

Our research aims to analyze how women are marginalized in various job settings, specifically regarding how pay gaps fluctuate based on the type of job and how male-dominated a particular workforce is.

## Introduction and data

The gender pay gap has always been a relevant issue for women seeking equal workplace rights.
Given the current political state and changes to DEI policies, this topic is crucial to understand and address from a statistical perspective.
We are interested in how gender pay gaps vary across time from 2013 to 2016, varying percentages of female representation in the workforce, and specific major job categories, such as the Management, Business, and Financial sector.

We hypothesize that major job categories that tend to be “male-dominated” will have a more significant male-female pay gap and fewer women working in that career.
Our research question asks, to what extent does the gender pay gap vary between male-dominated and female-dominated workforces and across major job categories?

We will primarily consider the variables of female wages as a percent of male wages (`wage_percent_of_male`), major job category (`major_category`), percentage of females in the workforce (`percent_female`), and year of data collection ranging from 2013 to 2016 (`year`).

```{r}
#| label: load-packages
library(tidyverse)
library(tidymodels)
jobs_gender <- read_csv("data/jobs_gender.csv")
```

DELETE VARIABLES WE DIDN'T USE:

```{r}
#| label: mutate-variables-to-decimal-form-and-rename
# mutating percent_female to be displayed as a decimal
jobs_gender <- jobs_gender |>
  mutate(
# mutating percent_female to be displayed as a decimal
    percent_female = (percent_female * 0.01),
# mutating wage_percent_of_male to be displayed as a decimal
    wage_percent_of_male = (wage_percent_of_male * 0.01)
  ) |>
  rename(
# renaming total_earnings_male to median_earnings_male to be more clear
    median_earnings_male = total_earnings_male,
# renaming total_earnings_female to median_earnings_female to be more clear
    median_earnings_female = total_earnings_female,
# renaming total_earnings to median_earnings to be more clear
    median_earnings = total_earnings
  )
```

```{r}
#| label: creating-new-variables
jobs_gender <- jobs_gender |>
# omit all observations with NA values.
  na.omit(jobs_gender) |>
  mutate(
# creating wage_percent_of_female 
    wage_percent_of_female = (1 - wage_percent_of_male),
# creating median_earnings_gap_prop to measure the proportional difference between male and female wages. If the value is greater than zero, males tend to be paid more in their position.
    median_earnings_gap_prop = (median_earnings_male - median_earnings_female) / median_earnings_female,
# calculate workforce_gap_prop to calculate the proportional difference in number of male to female workers.
    workforce_gap_prop = (workers_male - workers_female) / total_workers,
# create male_dom_workforce as a binary factor where "Yes" means that there are more male workers than female workers, and "No" when there are more female workers.
    male_dom_workforce = as.factor(if_else(
      workers_male > workers_female, "Yes", "No")),
# create male_dom_earnings as a binary factor where "Yes" means that male workers tend to be paid more than female workers, and "No" when female workers are usually paid more.
    male_dom_earnings = as.factor(if_else(
      median_earnings_male > median_earnings_female, "Yes", "No"))
    )
```

The following plot visualizes the distribution of female wages as a percentage of male wages according to major job categories.

```{r}
#| label: scatterplot-wage-percentage-male
#| fig-asp: 0.5
#| fig-height: 8
jobs_gender |>
  ggplot(aes(x = wage_percent_of_male, color = major_category)) +
  geom_boxplot() +
  labs(
    title = "Figure 1: Distribution of female wages as percent of 
male wages according to each major job category",
    x = "Female wages as percent of male wages",
    color = "Major category",
    y = NULL
  ) +
  theme_minimal() +
  theme(axis.ticks.y = element_blank(),
  axis.text.y = element_blank())
```

```{r}
#| label: scatterplot-workforce-percentage-female
#| fig-asp: 0.5
#| fig-height: 8
jobs_gender |>
  ggplot(aes(x = percent_female, color = major_category)) +
  geom_boxplot() +
  labs(
    title = "Figure 2: Distribution of females in workforce 
according to each major job category",
    x = "Percent females in the workforce",
    color = "Major category"
  ) +
  theme_minimal() +
  theme(axis.ticks.y = element_blank(),
  axis.text.y = element_blank())
```

EDA ADD THESE VISUALIZATIONS / SUMMARIES: - Figure 3: Response variable - histogram, percent_wage_male

All data was collected between 2013 and 2016 from statistics provided by the U.S.
Bureau of Labor through the U.S.
Census.
There are 2089 observations total, with 12 columns.
Each observation is a different combination of the year observed and occupation (i.e., “2013” and “Legislators” is one row/observation, and there are four rows of "Legislators" across all years).
301 occupations are shown throughout the 4 years, and 22 occupations are not represented in every year.
Considering that this data was scrubbed of any identifying factors aside from gender and was made public by the U.S.
Bureau of Labor Statistics, there are no ethical concerns with the data itself.

Male-dominated fields will be specified through the creation of two binary variables: male_dom_workforce labels observations with "Yes" when the number of male workers is greater than the number of female workers and "No" when there are more female workers and male_dom_earnings labels observations with "Yes" when the total male earnings are greater than the total female earnings and "No" when there are higher female earnings.

EDA ADD THESE VISUALIZATIONS / SUMMARIES: - Table 1: Summary statistic - group by male_dom_earnings, count, year

96.8% of the majority male workforces in the sample have median male wages that are higher than female wages, compared with 97.7% of non-majority male workforces in the sample.

```{r}
#| label: exploratory-data-anaylsis-summary-stats
summary_stats <- jobs_gender |>
  group_by(major_category, year) |>
  summarize(
    median_earnings_yr = median(median_earnings, na.rm = TRUE),
    median_earnings_male_yr = median(median_earnings_male, na.rm = TRUE),
    median_earnings_female_yr = median(median_earnings_female, na.rm = TRUE),
    total_workers_yr = sum(total_workers, na.rm = TRUE)
  )
summary_stats
```

We have also transformed column names to provide more information and make data visualization and manipulation easier.
We have made percent_female and wage_percent_of_male into decimals rather than percentages.

Finally, We renamed the `total_earnings`, `total_earnings_male`, and `total_earnings_female` columns to `median_earnings`, `median_earnings_male`, and `median_earnings_female` given that the word "total" was misleading in communicating that the column represented the median earnings rather than all earnings for each group.

## Methodology

------------------------------------------------------------------------

This section includes a brief description of your analysis process.
Explain the reasoning for the types of analyses you do, exploratory, inferential, or modeling.
If you’ve chosen to do inference, make sure to include a justification for why that inferential approach is appropriate.
If you’ve chosen to do modeling, describe the model(s) you’re fitting, predictor variables considered for the model including any interactions.
Additionally, show how you arrived at the final model by describing the model selection process, interactions considered, variable transformations (if needed), assessment of conditions and diagnostics, and any other relevant considerations that were part of the model fitting process.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

We chose to do an exploratory analysis first to better understand the relationships between variables.
We created a bar chart that shows the proportions of workforces that do or do not have a median male wage higher than median female wages that is dodged based on the major job category.
EXPLAIN BRIEFLY WHY

We chose to create three models to predict female wages as a percentage of male wages based on `major_category` and `percent_female`.
We did not choose to use `year` as a variable because the scatterplot did not indicate that it could be a promising predictor.
We created a scatterplot that shows the female wages as a percent of male wages on the y-axis and the percentage of the workforce that is female on the x-axis with lines to designate the trends based on year (2013 vs. 2016) as we hypothesize that the percentage of the workforce that is female will be a major predictor of wage gaps.

We created three linear regression models.
Our first model is a simple linear regression model that predicts the female wages as a percent of male wages based on the percent of the workforce that is female.
Our second model is an additive linear model which uses the predictors the percentage of the workforce that is female and the major job category.
Our third model is an interaction model between the percentage of the workforce that is female and the major job category.
EXPLAIN WHY FOR EACH ----- Ellie

We created two logistic regression models.
The fourth model predicts whether the total male earnings are greater than the total female earnings based on whether the workforce is majority male.
Our fifth model is an additive model that uses the major job category and whether the workforce is majority male as predictors.
EXPLAIN WHY FOR EACH --- Emma

SHOW HOW WE ARRIVED AT THE FINAL MODEL!!!

## Results

*Model 1*

According to Figure 4, the relationship between the percent of the workforce that is female and female wages as a percent of male wages appears to be moderately strong, positive, and linear.
Given this, we decided to fit a simple linear model with the percent of the female workforce as a predictor.

```{r}
#| label: scatterplot-simple-linear-model
#| fig-asp: 0.7
#| fig-height: 4

ggplot(jobs_gender, aes(x = percent_female, y = wage_percent_of_male)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Figure 4: Relationship between gender representation in the 
workforce and wage gaps",
    x = "Percent of workforce that is female",
    y = "Female wages as percent of male wages",
  ) +
  theme_minimal()
```

```{r}
#| label: earnings-gap-workforce-gap-years-linear
#| echo: false

simple_linear_fit <- linear_reg() |>
  fit(wage_percent_of_male ~ percent_female, data = jobs_gender)

tidy(simple_linear_fit)
```

$$\widehat{wage~percent~of~male} = 0.82 + 0.04 \times percent~female~workforce$$

Based on the linear model above, we predict that female employee wages as a percent of male wages when 0% of the workforce is female will be 82.1%, on average.
For every additional percentage point in percent of female employees in the workforce, we expect the female wage as a percent of male wage to be higher, on average, by 4.3 percentage points.

```{r}
#| label: r2-model1
#| eval: false
glance(simple_linear_fit)
```

$Adjusted~R^2=0.012$ means that 1.2% of the variation in female wage as a percent of male wage is explained by the percent of females in the workforce.
$Adjusted~R^2$ was used in order to compare the effectiveness of the simple model with the following models with multiple predictors.

*Model 2*

Considering how the distribution of female wages as a percent of male wages (see Figure 1) varies based on the major job category, the following additive linear model uses both the percent of females in the workforce and the major job category as predictors.

```{r}
#| label: additive-linear-model-fit
#| eval: false
additive_linear_model <- linear_reg() |>
  fit(wage_percent_of_male ~ percent_female + major_category, data = jobs_gender)
tidy(additive_linear_model)
```

```{r}
#| label: additive-linear-model-glance
#| eval: false
glance(additive_linear_model)
```

*Model 3*

Considering the distribution of the percent of females in the workforce (see Figure 2) also varies based on the major job category, it is important to consider the interaction between these predictor variables. Figure 6 depicts this interaction linear model.

```{r}
#| label: scatterplot-interaction-lienar-model
#| fig-width: 10
ggplot(jobs_gender, aes(x = percent_female, y = wage_percent_of_male, color = major_category)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Figure 6: Relationship between gender differences in workforce and wage 
gaps by job category",
    x = "Percent of workforce that is female",
    y = "Female wages as percent of male wages",
    color = "Major job category"
  ) +
  theme_minimal()
```

------------------------------------------------------------------------

EMMA: Model 4: We created a logistic model to predict whether the median male wages at a company are higher than the median female wages based on the percentage of the workforce that is female.

```{r}
#| label: earnings-workforce-logistic-reg-models
earnings_log_fit <- logistic_reg() |>
	fit(male_dom_earnings ~ male_dom_workforce, data = jobs_gender)

tidy(earnings_log_fit)
```

$$\log\Big(\frac{\hat{p}}{1-\hat{p}}\Big) = 3.36 + 0.41 \times percent~female~workforce$$ Model 5:

Based on Figure 4, all job categories have a higher proportion of observation with higher median male wages, though the Sales and Office; Computer, Engineering, and Science; and Production, Transportation, and Material Moving categories show the largest proportions of higher median male wages under the `male_dom_earnings` variable.
Given this visual, we have decided to fit a logistic regression model to predict whether median male wages are higher than median female wages for a given observation based on the major job category and whether the workforce was majority male.

```{r}
#| label: earnings-job-category
ggplot(jobs_gender, aes(x = major_category, fill = male_dom_earnings)) +
  geom_bar(position = "fill") +
  labs(
    title = "Figure 4: Higher median male wages based on job category",
    x = "Major job category",
    y = "Proportion",
    fill = "Median male wage higher?"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Discussion

In this section you’ll include a summary of what you have learned about your research question along with statistical arguments supporting your conclusions.
In addition, discuss the limitations of your analysis and provide suggestions on ways the analysis could be improved.
Any potential issues pertaining to the reliability and validity of your data and appropriateness of the statistical analysis should also be discussed here.
Lastly, this section will include ideas for future work.

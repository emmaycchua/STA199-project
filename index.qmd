---
title: Differences in the Gender Pay Gap Across Male and Female-Dominated Occupation and Workplaces
subtitle: 2013 and 2016 trends in wages and workplace representation
execute:
  echo: true
---

Our research aims to analyze how women are marginalized in various job settings and categories, specifically regarding how pay gaps fluctuate based on how male-dominated a particular field is.

## Introduction and data

The gender pay gap has always been a relevant issue for women seeking equal workplace rights.
Given the current political state and changes to DEI policies, this topic is crucial to understand and address from a statistical perspective.
We are interested in how pay gaps vary across time from 2013 to 2016 and within specific major and minor job categories, such as the Management, Business, and Financial sector.

We hypothesize that occupations that tend to be “male-dominated” will have a more significant male-female pay gap and fewer women working in that career.
Our research question asks, to what extent does the gender pay gap vary between male-dominated and female-dominated occupations?

We will primarily consider the variables of earnings, occupation type, and gender representation in the workforce from 2013 to 2016.

All data was collected between 2013 and 2016 from statistics provided by the U.S.
Bureau of Labor through the U.S.
Census.
There are 2089 observations total, with 12 columns.
Each observation is a different combination of the year observed and occupation (i.e., “2013” and “Legislators” is one row/observation).
The variables of interest are the year, occupation, observation categories, how many workers there are in that occupation, the proportion of female workers, total earnings, and the percentage of a male wage that a woman earns.

Male-dominated fields will be specified through the creation of two binary variables: male_dom_workforce labels observations with "Yes" when the number of male workers is greater than the number of female workers and "No" when there are more female workers and male_dom_earnings labels observations with "Yes" when the total male earnings are greater than the total female earnings and "No" when there are higher female earnings.

We have also created a numerical variable of perc_male_earnings that measures the percentage of total workforce earnings that are from male employees.
We are also creating the variable median_earnings_gap to measure the difference between male and female wages.
If the value is greater than zero, males tend to be paid more in their positions.

We also added variables that simply transform columns to provide more information and make data visualization and manipulation easier.
One of those is percent_male which subtracts the percentage of female employees from 1 to calculate the percentage of male employees.
We also made percent_female and wage_percent_of_male into decimals rather than numbers.
Finally, we renamed the total_earnings columns to median_earn,ings given that the word "total" was misleading in communicating what the columns represented.

Considering that this data was scrubbed of any identifying factors aside from gender and was made public by the U.S.
Bureau of Labor Statistics, there are no ethical concerns with the data itself.

```{r}
#| label: load-packages
library(tidyverse)
library(tidymodels)
jobs_gender <- read_csv("data/jobs_gender.csv")
# original data frame
glimpse(jobs_gender)
```

```{r}
#| label: mutate-variables-to-decimal-form-and-rename
#| echo: false
# mutating percent_female to be displayed as a decimal
jobs_gender <- jobs_gender |>
  mutate(
# mutating percent_female to be displayed as a decimal
    percent_female = (percent_female * 0.01),
# mutating wage_percent_of_male to be displayed as a decimal
    wage_percent_of_male = (wage_percent_of_male * 0.01)
  ) |>
  rename(
# renaming total_earnings_male to median_earnings_male to be more clear
    median_earnings_male = total_earnings_male,
# renaming total_earnings_female to median_earnings_female to be more clear
    median_earnings_female = total_earnings_female,
# renaming total_earnings to median_earnings to be more clear
    median_earnings = total_earnings
  )
```

```{r}
#| label: creating-new-variables
#|echo: false
jobs_gender <- jobs_gender |>
# omit all observations with NA values.
  na.omit(jobs_gender) |>
  mutate(
# creating wage_percent_of_female 
    wage_percent_of_female = (1 - wage_percent_of_male),
# creating median_earnings_gap_prop to measure the proportional difference between male and female wages. If the value is greater than zero, males tend to be paid more in their position.
    median_earnings_gap_prop = (median_earnings_male - median_earnings_female) / median_earnings_female,
# calculate percentage of male workers in each occupation
    percent_male = (1 - percent_female),
# calculate workforce_gap_prop to calculate the proportional difference in number of male to female workers.
    workforce_gap_prop = (workers_male - workers_female) / total_workers,
# create male_dom_workforce as a binary factor where "Yes" means that there are more male workers than female workers, and "No" when there are more female workers.
    male_dom_workforce = as.factor(if_else(
      workers_male > workers_female, "Yes", "No")),
# create male_dom_earnings as a binary factor where "Yes" means that male workers tend to be paid more than female workers, and "No" when female workers are usually paid more.
    male_dom_earnings = as.factor(if_else(
      median_earnings_male > median_earnings_female, "Yes", "No"))
    )
```

The following plot visualizes the distribution of female wages as a percentage of male wages according to major job categories.

-   The median female wage as a percentage of male wage is the highest for Computer, Engineering, and Science. 

-   The median female wage as a percentage of male wage is lowest for Production, Transportation, and Material Moving


```{r}
#| label: scatterplot-wage-percentage-male
#| fig-asp: 0.5
#| fig-height: 8
#| echo: false
jobs_gender |>
  ggplot(aes(x = wage_percent_of_male, color = major_category)) +
  geom_boxplot() +
  labs(
    title = "Distribution of female wages as percent of male wages 
    according to each major job category",
    x = "Female wages as percent of male wages",
    color = "Major category"
  ) +
  theme_minimal()
```

96.8% of the majority male workforces in the sample have median male wages that are higher than female wages, compared with 97.7% of non-majority male workforces in the sample.

```{r}
#| label: earnings-workforce-binary-visualization
#| echo: false

ggplot(jobs_gender, aes(x = male_dom_workforce, fill = male_dom_earnings)) +
  geom_bar(position = "fill") +
  labs(
    title = "Gender pay gaps in majority male workforces",
    x = "Majority-male workforce",
    y = "Count",
    fill = "Median male wage higher than female"
  ) +
  theme_minimal()

jobs_gender |>
  count(male_dom_workforce, male_dom_earnings) |>
  group_by(male_dom_workforce) |>
  summarize(male_dom_workforce, male_dom_earnings, p = n / sum(n))
```

```{r}
#| label: exploratory-data-anaylsis-summary-stats
#| echo: false
#added _yr to the ends to indicate that they're for this function, not the original df.

summary_stats <- jobs_gender |>
  group_by(major_category, year) |>
  summarize(
    median_earnings_yr = median(median_earnings, na.rm = TRUE),
    median_earnings_male_yr = median(median_earnings_male, na.rm = TRUE),
    median_earnings_female_yr = median(median_earnings_female, na.rm = TRUE),
    total_workers_yr = sum(total_workers, na.rm = TRUE),  # Summing total workers
  )

summary_stats
```

```{r}
#| label: histogram-perc-male-and-job-category
#| echo: false
#don't think this one rly makes sense 
jobs_gender |>
  ggplot(aes(x = percent_male, color = major_category, fill = major_category)) +
  geom_histogram()
```

```{r}
#| label: boxplot-workers-gender
#| echo: false
#help
jobs_gender |>
  ggplot(aes(x = total_workers, y = workers_male, color = workers_male)) +
geom_boxplot()
```

## Methodology

This section includes a brief description of your analysis process.
Explain the reasoning for the types of analyses you do, exploratory, inferential, or modeling.
If you’ve chosen to do inference, make sure to include a justification for why that inferential approach is appropriate.
If you’ve chosen to do modeling, describe the model(s) you’re fitting, predictor variables considered for the model including any interactions.
Additionally, show how you arrived at the final model by describing the model selection process, interactions considered, variable transformations (if needed), assessment of conditions and diagnostics, and any other relevant considerations that were part of the model fitting process.

We chose to do an exploratory analysis first to better understand the relationships between variables. We chose to run three analyses to determine which model would be the most effective.

## Results

This is where you will discuss your overall finding and describe the key results from your analysis.
The goal is not to interpret every single element of an output shown, but instead to address the research questions, using the interpretations to support your conclusions.
Focus on the variables that help you answer the research question and that provide relevant context for the reader.

Model 1: We created a linear regression model to predict the female wages as a percent of male wages based on the percent of the workforce that is female and whether the observation year was 2013 or 2016.

```{r}
#| label: earnings-gap-workforce-gap-years
#| echo: false
#| warning: false

jobs_gender_year <- jobs_gender |>
  filter(year == 2013 | year == 2016) |>
  mutate(year = as.factor(year))

ggplot(jobs_gender_year, aes(
  x = percent_female, 
  y = wage_percent_of_male, 
  color = year)
  ) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Relationship between gender differences in workforce and wage gaps",
    x = "Percent of workforce that is female",
    y = "Female wages as percent of male wages",
    color = "Year"
  ) +
  theme_minimal()
```

```{r}
#| label: earnings-gap-workforce-gap-years-linear
#| echo: false

wages_female_year_fit <- linear_reg() |>
  fit(wage_percent_of_male ~ percent_female + year, data = jobs_gender_year)

tidy(wages_female_year_fit)
```

$$\widehat{wage~percent~of~male} = 0.82 + 0.04 \times percent~female~workforce + 0.004 \times year$$

Based on the linear model above, we predict that female employee wages as a percent of male wages with 0% of the workforce being female and the year of observation being 2013 will be 81.9%, on average.
Holding all other variables constant, for every additional percentage point in percent of female employees in the workforce, we expect the female wage as a percent of male wage to be higher, on average, by 4.2 percentage points.
Holding all other variables constant, for observations noted in 2016 as opposed to 2013, we expect the female wage as a percent of male wage to be higher, on average, by 0.4 percentage points.

```{r}
#| label: r2-model1
#| echo: false
glance(wages_female_year_fit)
```

$Adjusted~R^2=0.009$means that 0.9% of the variation in female wage as a percent of male wage is explained by percent female workforce and the year.

Model 2: We created an additive linear model to predict the female wages as a percent of male wages based on the percentage of the workforce that is female and the major job category.

```{r}
#| label: earnings-job-category
#| echo: false

ggplot(jobs_gender, aes(x = male_dom_earnings, fill = major_category)) +
  geom_bar(position = "fill") +
  labs(
    title = "Higher median male wages based on job category",
    x = "Median male wage higher than median female wage",
    y = "Proportion",
    fill = "Major job category"
  ) +
  theme_minimal()
```

```{r}
#| label: earnings-job-category-point
#| fig-width: 10
#| echo: false
ggplot(jobs_gender, aes(x = percent_female, y = wage_percent_of_male, color = major_category)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Relationship between gender differences in workforce and wage 
gaps by job category",
    x = "Percent of workforce that is female",
    y = "Female wages as percent of male wages",
    color = "Major job category"
  ) +
  theme_minimal()
```

```{r}
#| label: percent-wage-female-linear-model2
#| echo: false

wages_female_jobs_additive <- linear_reg() |>
  fit(wage_percent_of_male ~ percent_female + major_category, data = jobs_gender)

tidy(wages_female_jobs_additive)
glance(wages_female_jobs_additive)
```

Model 3: We created an interactive linear model to predict the female wages as a percent of male wages based on the percentage of the workforce that is female and the major job category.

```{r}
#| label: percent-wage-female-linear-model3
#| echo: false

wages_female_jobs_fit_interactive <- linear_reg() |>
  fit(wage_percent_of_male ~ percent_female * major_category, data = jobs_gender)

tidy(wages_female_jobs_fit_interactive)
glance(wages_female_jobs_fit_interactive)
```

Model 4: We created a logistic model to predict whether the median male wages at a company are higher than the median female wages based on the percentage of the workforce that is female.

```{r}
#| label: earnings-workforce-logistic-reg-models
#| echo: false

earnings_log_fit <- logistic_reg() |>
	fit(male_dom_earnings ~ percent_female, data = jobs_gender)

tidy(earnings_log_fit)
```

$$\log\Big(\frac{\hat{p}}{1-\hat{p}}\Big) = 3.36 + 0.41 \times percent~female~workforce$$

## Discussion

In this section you’ll include a summary of what you have learned about your research question along with statistical arguments supporting your conclusions.
In addition, discuss the limitations of your analysis and provide suggestions on ways the analysis could be improved.
Any potential issues pertaining to the reliability and validity of your data and appropriateness of the statistical analysis should also be discussed here.
Lastly, this section will include ideas for future work.
